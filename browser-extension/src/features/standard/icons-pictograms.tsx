import classes from './icons-pictograms.module.css';
import PrunCss from '@src/infrastructure/prun-ui/prun-css';
import features from '@src/feature-registry';
import {
  applyCssRule,
  applyRawCssRule,
  endCssAtScope,
  startCssAtScope,
} from '@src/infrastructure/prun-ui/refined-prun-css';
import { companyStore } from '@src/infrastructure/prun-api/data/company';
import { objectKeys } from 'ts-extras';

function init() {
  if (companyStore.value?.code !== 'SN') {
    return;
  }

  applyCssRule(`.${PrunCss.ColoredIcon.container}`, classes.container);
  applyCssRule(`.${PrunCss.ColoredIcon.container}:before`, classes.containerBefore);
  applyCssRule(`.${PrunCss.ColoredIcon.label}:before`, classes.labelBefore);

  startCssAtScope('@container (height < 24px)');
  applyCssRule(`.${PrunCss.ColoredIcon.container}:before`, classes.hide);
  applyCssRule(`.${PrunCss.ColoredIcon.label}:before`, classes.hide);
  endCssAtScope();

  for (const category of objectKeys(categories)) {
    const selector = `.${PrunCss.ColoredIcon.container}[data-rp-category='${category}']:before `;
    const rule = createRule(categories[category]);
    applyRawCssRule(selector + rule);
  }
  for (const material of objectKeys(materials)) {
    const selector = `.${PrunCss.ColoredIcon.container}[data-rp-ticker='${material}']:before `;
    const rule = createRule(materials[material]);
    applyRawCssRule(selector + rule);
  }
}

function createRule(pictogram: Pictogram) {
  const hasOptions = typeof pictogram !== 'string';
  const character = hasOptions ? pictogram[0] : pictogram;
  let fontSize = pictogramFontSize[character];
  let rule = '{';
  if (hasOptions) {
    const options = pictogram[1];
    if (options.opacity) {
      rule += ` opacity: ${options.opacity};`;
    }
    if (options.fontSize) {
      fontSize = options.fontSize;
    }
  }
  rule += ` content: '${character}';`;
  if (fontSize) {
    rule += ` font-size: calc(${fontSize} * 2em);`;
  }
  rule += ' }';
  return rule;
}

type Pictogram = string | [string, { opacity?: number; fontSize?: number }];

const pictogramFontSize: Record<string, number> = {
  'â˜€': 1.2,
  'â™¨': 1.2,
  'â˜£': 1.8,
  'â›“': 1.6,
  'âœˆ': 1.8,
  'â„': 1.2,
  'ğŸ': 1.1,
  'ğŸ”§': 1.1,
  'ğŸ”¶': 1.1,
  'ğŸ”·': 1.1,
  'ğŸ”º': 1.5,
  'ğŸ›': 1.1,
  'ğŸ›¡': 1.2,
  'ğŸ›¢': 1.2,
  'ğŸ›¸': 1.2,
  'ğŸ§°': 1.1,
  'ğŸ§³': 1.2,
  'ğŸª‘': 1.1,
  'ğŸ‘“': 1.4,
  'ğŸš¿': 1.4,
  'ğŸ”²': 1.1,
  'ğŸŸ': 1.1,
  'ğŸ§µ': 1.2,
  'ğŸ§Š': 1.2,
  'ğŸ”­': 1.1,
};

const categories: Record<string, Pictogram> = {
  'agricultural products': '',
  alloys: ['', { opacity: 0.4 }],
  chemicals: 'ğŸ§ª',
  'construction materials': '',
  'construction parts': '',
  'construction prefabs': '',
  'consumables (basic)': ['', { opacity: 0.2 }],
  'consumables (luxury)': ['', { opacity: 0.2 }],
  drones: 'âœˆ',
  'electronic devices': '',
  'electronic parts': '',
  'electronic pieces': '',
  'electronic systems': ['ğŸ–¥', { opacity: 0.6 }],
  elements: 'â›°',
  'energy systems': '',
  fuels: '',
  gases: 'â˜',
  liquids: '',
  'medical equipment': '',
  metals: ['â›°', { opacity: 0.3 }],
  minerals: ['â›°', { opacity: 0.4 }],
  ores: 'ğŸ¥”',
  plastics: '',
  'ship engines': ['', { opacity: 0.4 }],
  'ship kits': ['', { opacity: 0.4 }],
  'ship parts': '',
  'ship shields': 'ğŸ›¡',
  'software components': 'ğŸ’¾',
  'software systems': 'ğŸ’¾',
  'software tools': 'ğŸ’¾',
  textiles: '',
  'unit prefabs': ['', { opacity: 0.4 }],
  utility: '',
};

const materials: Record<string, Pictogram> = {
  AAR: 'ğŸ“¡',
  ABH: 'ğŸ›¸',
  ADE: 'ğŸ',
  ADR: 'ğŸ‘¨â€âš•ï¸',
  ADS: 'ğŸ”Š',
  AEF: 'ğŸ§‡',
  AEN: 'ğŸš€',
  AFP: 'ğŸš°',
  AFR: 'ğŸ§¨',
  AGS: ['ğŸª‘', { opacity: 0.6 }],
  AHP: 'ğŸ›¡',
  AIR: 'â˜',
  AL: 'â¬œ',
  ALE: 'ğŸº',
  ALG: 'ğŸƒ',
  AMM: 'ğŸ©¸',
  ANZ: 'â›°',
  ASE: 'â›“',
  AST: 'ğŸŸª',
  ATA: 'ğŸ—',
  ATP: 'ğŸ§±',
  AU: 'ğŸŸ¨',
  AWF: 'ğŸ“»',
  BAC: 'ğŸ§«',
  BBH: 'ğŸ›¸',
  BCO: ['ğŸ”Œ', { opacity: 0.4 }],
  BDE: 'ğŸ',
  BE: 'â›°',
  BEA: 'ğŸ¥’',
  BER: 'ğŸ’',
  BFP: 'ğŸš°',
  BFR: ['ğŸ§¨', { fontSize: 0.8 }],
  BGC: ['ğŸ”Œ', { opacity: 0.4 }],
  BGO: 'ğŸ”·',
  BGS: ['ğŸª‘', { opacity: 0.6 }],
  BHP: 'ğŸ›¡',
  BID: 'ğŸ“»',
  BL: 'ğŸ’§',
  BMF: 'ğŸ–¥',
  BND: 'ğŸ§»',
  BOR: 'ğŸ’',
  BOS: 'ã€°',
  BR1: 'â˜',
  BR2: 'â˜',
  BRO: 'ğŸ”º',
  BRS: 'â˜',
  BSC: 'ğŸ”­',
  BSE: 'â›“',
  BTA: 'ğŸ—',
  BTS: 'ğŸ§ª',
  BWS: 'ğŸ’»',
  C: 'ğŸ©',
  CA: 'â›°',
  CAF: 'ğŸŒ¿',
  CAP: 'ğŸ”‹',
  CBL: ['ğŸ”‹', { fontSize: 1.1 }],
  CBM: 'ğŸ”‹',
  CBS: ['ğŸ”‹', { fontSize: 0.8 }],
  CC: ['ğŸ›', { opacity: 0.6 }],
  CD: 'ğŸ’»',
  CF: 'ğŸ§µ',
  CHA: 'ğŸ§³',
  CL: 'ğŸ¥',
  CLI: 'ğŸ¥¯',
  COF: 'â˜•',
  COT: 'ğŸ§µ',
  CQL: ['ğŸ›', { fontSize: 1.2 }],
  CQM: 'ğŸ›',
  CQS: ['ğŸ›', { fontSize: 1 }],
  CQT: ['ğŸ›', { fontSize: 0.75 }],
  CRU: 'â„',
  CST: 'â„',
  CTF: 'ğŸ§µ',
  CU: 'ğŸŸ§',
  DCL: ['ğŸ§Š', { fontSize: 1.4 }],
  DCM: 'ğŸ§Š',
  DCS: ['ğŸ§Š', { fontSize: 1 }],
  DEC: 'ğŸ–¼',
  DIS: 'ğŸ’»',
  DOU: 'âœˆ',
  DW: 'ğŸ§ƒ',
  ENG: 'ğŸš€',
  EPO: 'ğŸ§ª',
  EXO: 'ğŸ‘·â€â™€ï¸',
  FAL: 'ğŸŸ¦',
  FAN: 'ğŸ“»',
  FC: 'ğŸš¿',
  FE: 'ğŸŸ¦',
  FET: 'ğŸŸª',
  FF: ['â˜€', { opacity: 0.5 }],
  FFC: 'â˜€',
  FIM: 'ğŸ¥¡',
  FIR: ['ğŸ†', { fontSize: 0.8 }],
  FLO: 'ğŸ›¢',
  FLP: ['ğŸš°', { opacity: 0.4 }],
  FOD: 'ğŸ’Š',
  FSE: 'ğŸš€',
  FUN: 'ğŸ¡',
  GAL: 'ğŸ¥¯',
  GC: 'â˜',
  GEN: 'ğŸš€',
  GIN: 'ğŸ¥ƒ',
  GL: 'ğŸ”²',
  GNZ: 'â›°',
  GRA: 'ğŸ‡',
  GRN: 'ğŸŒ¾',
  GV: ['â™¨', { opacity: 0.4 }],
  H: 'ğŸ’«',
  H2O: 'ğŸ’§',
  HAB: 'ğŸ ',
  HAL: 'ğŸ’',
  HCC: ['ğŸ”Œ', { opacity: 0.4 }],
  HCP: 'ğŸŒ²',
  HD: 'ğŸ’»',
  HE: 'ğŸŒŒ',
  HE3: 'ğŸ’¦',
  HER: 'ğŸŒ¶',
  HEX: 'ğŸ¥ƒ',
  HHP: 'ğŸ›¡',
  HMS: 'ğŸ‘©â€ğŸš’',
  HNZ: 'â›°',
  HOG: 'ğŸ‘“',
  HOP: 'ğŸŒ¾',
  HPC: 'ğŸ“±',
  HPR: 'ğŸ†',
  HSE: 'â›“',
  HSS: 'ğŸ‘¨â€ğŸš€',
  HTE: 'ğŸš€',
  HYR: 'ğŸ†',
  I: 'ğŸ©¸',
  INS: 'ğŸŒ«',
  KOM: 'ğŸ¯',
  LBH: 'ğŸ›¸',
  LC: 'ğŸ¥¼',
  LCB: ['ğŸ“¦', { fontSize: 1.1 }],
  LCR: 'ğŸ’',
  LDE: 'ğŸ',
  LDI: 'â–¶',
  LES: 'ğŸ¥›',
  LFE: 'ğŸ“¡',
  LFL: 'ğŸ§³',
  LFP: 'ğŸš°',
  LHP: 'ğŸ›¡',
  LIT: 'ğŸ’¡',
  LSE: 'â›“',
  LSL: 'ğŸ›¢',
  LST: 'ğŸ¥¯',
  LTA: 'ğŸ—',
  MAG: 'ğŸ§²',
  MAI: 'ğŸŒ½',
  MB: 'ğŸ«',
  MCB: 'ğŸ“¦',
  MCG: 'ğŸ§±',
  MEA: 'ğŸ±',
  MED: 'ğŸ©º',
  MFE: ['ğŸ“¡', { fontSize: 0.8 }],
  MFK: 'ğŸ”§',
  MFL: ['ğŸ§³', { fontSize: 1 }],
  MG: 'â›°',
  MGC: 'ğŸ§²',
  MHL: 'ğŸ’¡',
  MHP: 'ğŸ§',
  MPC: 'ğŸŸ',
  MSL: ['ğŸ›¢', { fontSize: 1 }],
  MTC: 'ğŸ§ª',
  MTP: 'ğŸ§«',
  MUS: 'ğŸ„',
  MWF: 'ğŸ«',
  N: 'ğŸ’§',
  NA: 'ğŸ§‚',
  NAB: 'ğŸ§‚',
  NCS: 'ğŸ©',
  NFI: 'ğŸ§µ',
  NG: 'ğŸ”²',
  NL: 'ğŸ§µ',
  NOZ: 'â›°',
  NS: 'ğŸ§ª',
  NST: 'ğŸ’Š',
  NUT: 'ğŸ¥œ',
  NV1: 'ğŸ’¾',
  NV2: 'ğŸ’¾',
  O: 'ğŸ’¨',
  OFF: 'ğŸ“ ',
  OVE: 'ğŸ§¥',
  PCB: 'ğŸ«',
  PDA: 'ğŸ“±',
  PE: 'âš¾',
  PG: 'ğŸ',
  PIB: 'ğŸ“',
  PK: 'ğŸ’Š',
  POW: ['ğŸ”‹', { fontSize: 0.7 }],
  PPA: 'ğŸ¥£',
  PSH: 'ğŸ›¡',
  PSL: ['ğŸ§»', { fontSize: 1.2 }],
  PSM: 'ğŸ§»',
  PSS: ['ğŸ§»', { fontSize: 0.8 }],
  PT: 'ğŸ”Œ',
  PWO: 'ğŸ¦º',
  QCR: 'ğŸ†',
  RAD: 'ğŸ“»',
  RAG: ['ğŸ†', { fontSize: 0.8 }],
  RAM: 'ğŸ',
  RAT: 'ğŸ¥«',
  RBH: 'ğŸ›¸',
  RCO: 'ğŸ§¶',
  RCS: 'ğŸ–¥',
  RCT: 'ğŸ†',
  RDE: 'ğŸ',
  RDL: 'âœˆ',
  RDS: 'âœˆ',
  REP: 'ğŸ§°',
  RG: 'ğŸ”²',
  RGO: 'ğŸ”¶',
  RHP: 'ğŸ›¡',
  ROM: 'ğŸ“€',
  RSE: 'â›“',
  RSH: 'ğŸ›¡',
  RSI: 'ğŸ§¶',
  RTA: 'ğŸ—',
  S: 'ğŸŸ¡',
  SAR: 'ğŸ”­',
  SC: 'ğŸ’‰',
  SCB: ['ğŸ“¦', { fontSize: 0.9 }],
  SCN: 'ğŸ”­',
  SCR: 'ğŸ’',
  SEA: 'ğŸŒ«',
  SEN: 'ğŸ”­',
  SEQ: 'ğŸ©º',
  SF: ['ğŸ›¢', { opacity: 0.5 }],
  SFE: ['ğŸ“¡', { fontSize: 0.7 }],
  SFK: ['ğŸ”§', { fontSize: 0.9 }],
  SFL: ['ğŸ§³', { fontSize: 0.8 }],
  SI: 'ã€°',
  SIL: 'ğŸ§µ',
  SOI: 'ğŸ¥”',
  SOL: ['âš¡', { fontSize: 0.8 }],
  SP: 'âš¡',
  SSC: ['â›“', { opacity: 0.4 }],
  SSL: ['ğŸ›¢', { fontSize: 0.8 }],
  STL: 'ğŸ§Š',
  STR: 'ğŸ',
  SU: 'âš•',
  SUN: 'ğŸ‘–',
  SWF: ['ğŸ«', { fontSize: 0.9 }],
  TA: 'ğŸ”˜',
  TAI: 'ğŸ¥¯',
  TCB: ['ğŸ“¦', { fontSize: 0.75 }],
  TCL: 'â˜£',
  TCS: 'â›°',
  TCU: 'ğŸ›',
  THP: 'ğŸ§±',
  TI: 'ğŸŸª',
  TPU: 'ğŸ§®',
  TRA: 'ğŸ”Š',
  TRN: 'ğŸŸ',
  TRU: 'ğŸ—¼',
  TSH: 'ğŸ›¡',
  TUB: 'ğŸ§ª',
  UTS: ['ğŸ› ', { opacity: 0.4 }],
  VCB: ['ğŸ“¦', { fontSize: 1.1 }],
  VEG: 'ğŸ…',
  VG: 'ğŸ§ª',
  VIT: 'ğŸ¶',
  VSC: ['ğŸ“¦', { fontSize: 0.8 }],
  W: 'ğŸŸ«',
  WAL: 'ğŸŸ«',
  WCB: ['ğŸ“¦', { fontSize: 1.1 }],
  WIN: 'ğŸ·',
  WOR: 'ğŸ¨',
  WR: 'ğŸ’§',
  WS: 'ğŸ”¬',
  ZIR: 'ğŸ’',
};

void features.add({
  id: 'icons-pictograms',
  init,
});
